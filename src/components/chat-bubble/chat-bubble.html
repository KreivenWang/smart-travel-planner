<div [ngClass]="['flex', isUser ? 'justify-end' : 'justify-start']">
  <div
    [ngClass]="[
      'flex',
      'max-w-[80%]',
      isUser ? 'flex-row-reverse' : 'flex-row',
      'items-start',
      'space-x-3'
    ]"
  >
    <!-- Avatar -->
    <div
      [ngClass]="[
        'flex-shrink-0',
        'w-8',
        'h-8',
        'rounded-full',
        'flex',
        'items-center',
        'justify-center',
        isUser ? 'bg-blue-600 text-white' : 'bg-green-100 text-green-700'
      ]"
    >
      <i [ngClass]="{ 'pi pi-android': !isUser, 'pi pi-user': isUser }"></i>
    </div>

    <!-- Message Bubble -->
    <div
      [ngClass]="[
        'rounded-2xl',
        'px-4',
        'py-3',
        isUser
          ? 'bg-blue-600 text-white rounded-br-md'
          : 'bg-white text-gray-800 rounded-bl-md shadow-sm border',
        isUser ? 'ml-3' : 'mr-3'
      ]"
    >
      <div class="whitespace-pre-wrap text-sm leading-relaxed">
        {{ message.content }}
        <span
          *ngIf="isStreaming"
          class="inline-block w-2 h-4 bg-current ml-1 animate-pulse opacity-70"
        ></span>
      </div>
      <div [ngClass]="['text-xs', 'mt-2', isUser ? 'text-blue-100' : 'text-gray-500']">
        {{ message.timestamp | date : 'HH:mm' }}
      </div>
    </div>
  </div>
</div>
